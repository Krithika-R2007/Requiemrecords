<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Haunted Vinyl Diary - A gamified memory-recording web application with a dark, haunting aesthetic">
    <meta name="theme-color" content="#000000">
    <title>Haunted Vinyl Diary</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kirang+Haerang&family=Creepster&family=Nosifer&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/intro.css">
    <link rel="stylesheet" href="css/recording.css">
    <link rel="stylesheet" href="css/log.css">
    <link rel="stylesheet" href="css/vinyl.css">
    <link rel="stylesheet" href="css/seance.css">
    <link rel="stylesheet" href="css/story.css">
</head>
<body>
    <!-- Intro State -->
    <div id="intro-container" class="state-container hidden" role="region" aria-label="Introduction sequence">
        <video id="intro-video" class="intro-video" aria-label="Haunted Vinyl Diary introduction video">
            <source src="assets/intro.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- Background Media (persists across states) -->
    <div id="background-media" aria-hidden="true">
        <video id="loop-video" class="background-video" loop muted playsinline aria-label="Background atmospheric video">
            <source src="assets/loop.mp4" type="video/mp4">
        </video>
        <audio id="background-audio" loop volume="0.5" aria-label="Background atmospheric music">
            <source src="assets/bg1.mp3" type="audio/mpeg">
        </audio>
    </div>
    
    <!-- Click to Start Overlay (for autoplay restrictions) -->
    <div id="click-to-start" class="click-overlay">
        <div class="click-content">
            <h1>Requiem Records</h1>
            <p class="click-instruction">Click anywhere to enter the darkness...</p>
        </div>
    </div>

    <!-- Main Interface State -->
    <div id="main-container" class="state-container" role="main" aria-label="Main navigation">
        <div class="main-content">
            <nav class="button-container" aria-label="Primary navigation">
                <button id="start-btn" class="nav-button" aria-label="Start recording a new memory">
                    <img src="assets/start.png" alt="" aria-hidden="true" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('sr-only');">
                    <span class="sr-only button-fallback-text">Start Recording</span>
                </button>
                <button id="log-btn" class="nav-button" aria-label="View your recorded memories log">
                    <img src="assets/log.png" alt="" aria-hidden="true" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('sr-only');">
                    <span class="sr-only button-fallback-text">View Log</span>
                </button>
                <button id="next-btn" class="nav-button" aria-label="Explore vinyl spinning section">
                    <img src="assets/next.png" alt="" aria-hidden="true" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('sr-only');">
                    <span class="sr-only button-fallback-text">Next Section</span>
                </button>
                <button id="seance-btn" class="nav-button" aria-label="Enter the s√©ance room">
                    <img src="assets/seance.png" alt="" aria-hidden="true" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('sr-only');">
                    <span class="sr-only button-fallback-text">S√©ance Room</span>
                </button>
            </nav>
        </div>
    </div>

    <!-- Recording State -->
    <div id="recording-container" class="state-container hidden" role="region" aria-label="Recording in progress">
        <div class="recording-content">
            <div id="recording-message" class="scary-message" role="status" aria-live="polite">Ready to capture your soul...</div>
            
            <div class="recording-controls">
                <button id="record-button" class="record-btn" aria-label="Start or stop recording">
                    <span class="record-icon">‚óè</span>
                    <span class="record-text">Start Recording</span>
                </button>
                
                <div id="recording-indicator" class="recording-indicator hidden" role="status" aria-label="Recording indicator">
                    <span class="pulse"></span>
                    <span class="recording-time">00:00</span>
                </div>
            </div>
            
            <button id="back-to-main" class="back-button" aria-label="Return to main menu">‚Üê Back</button>
        </div>
    </div>

    <!-- Log Interface State -->
    <div id="log-container" class="state-container hidden" role="region" aria-label="Memory log">
        <div class="log-content">
            <div class="log-header">
                <h2 class="scary-text" id="log-title">Your Haunted Memories</h2>
                <button id="close-log-btn" class="close-button" aria-label="Close memory log and return to main menu">√ó</button>
            </div>
            <div id="log-entries" class="log-entries" role="list" aria-labelledby="log-title">
                <!-- Entries will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Vinyl Spinning State -->
    <div id="vinyl-container" class="state-container hidden" role="region" aria-label="Vinyl spinning section">
        <!-- Playlist Sidebar -->
        <div class="playlist-sidebar" role="complementary" aria-label="Horror music playlist">
            <div class="playlist-header">
                <h3>üéµ Horror Playlist</h3>
                <div class="playlist-info">
                    <span id="current-track-number">Track 1</span> / <span id="total-tracks">10</span>
                </div>
            </div>
            <div class="playlist-tracks" id="playlist-tracks">
                <!-- Tracks will be dynamically inserted here -->
            </div>
        </div>
        
        <!-- Main Vinyl Content -->
        <div class="vinyl-content">
            <div class="vinyl-wrapper" role="img" aria-label="Animated spinning vinyl record">
                <video id="vinyl-video" class="vinyl-disc" loop muted playsinline aria-label="Spinning vinyl animation">
                    <source src="assets/nxt.mp4" type="video/mp4">
                    <!-- Fallback to image if video doesn't load -->
                    <img id="vinyl-image" src="assets/nxt.png" alt="" aria-hidden="true">
                </video>
            </div>
            <div id="vinyl-api-content" class="api-content" role="article" aria-live="polite">
                <!-- API-fetched content will be displayed here -->
            </div>
            <button id="close-vinyl-btn" class="close-button" aria-label="Close vinyl section and return to main menu">√ó</button>
            <button id="next-song-btn" class="next-song-button" aria-label="Play next scary song">‚è≠ Next Song</button>
        </div>
    </div>

    <!-- Spooky Story Container -->
    <div id="story-container" class="state-container hidden" role="region" aria-label="Spooky story">
        <video id="story-intro-video" class="story-video hidden" aria-label="Story introduction video">
            <source src="assets/inb.mp4" type="video/mp4">
        </video>
        <div id="story-content" class="story-content hidden">
            <div class="story-page" style="background-image: url('assets/page.png');">
                <div class="story-text" id="story-text">
                    <!-- Story will be generated here -->
                </div>
            </div>
            <button id="close-story-btn" class="close-button" aria-label="Close story">√ó</button>
        </div>
    </div>

    <!-- S√©ance Room State -->
    <div id="seance-container" class="state-container hidden" role="region" aria-label="S√©ance room">
        <video id="seance-video" class="seance-video" loop muted playsinline>
            <source src="assets/summon.mp4" type="video/mp4">
        </video>
        <div class="summon-button-wrapper">
            <button id="summon-btn" class="summon-button" aria-label="Summon a spirit">
                <img src="assets/summon-b.png" alt="Summon">
            </button>
        </div>
        <button id="back-from-seance-btn" class="close-button" style="position: absolute; top: 2rem; left: 2rem; z-index: 20;" aria-label="Back to main">‚Üê</button>
    </div>

    <!-- Summoning State -->
    <div id="summoning-container" class="state-container hidden" role="region" aria-label="Summoning in progress">
        <video id="summoning-video" class="summoning-video" playsinline>
            <source src="assets/summons.mp4" type="video/mp4">
        </video>
    </div>

    <!-- Ghost Encounter State -->
    <div id="ghost-encounter-container" class="state-container hidden" role="region" aria-label="Ghost encounter">
        <img id="ghost-background" class="ghost-background" src="assets/s.png" alt="S√©ance background">
        
        <div class="ghost-overlay" id="ghost-overlay">
            <img id="ghost-image" src="" alt="Summoned ghost">
        </div>
        
        <div class="ghost-info-panel" id="ghost-info-panel">
            <h3 class="ghost-name" id="ghost-name"></h3>
            <p class="ghost-probability">
                Probability: <span class="rarity" id="ghost-rarity"></span>
            </p>
            <div class="danger-level">
                <span class="danger-label">Danger:</span>
                <span class="danger-value" id="danger-value"></span>
                <div class="danger-bars" id="danger-bars"></div>
            </div>
        </div>
        
        <div class="ghost-dialogue" id="ghost-dialogue">
            <p class="ghost-greeting" id="ghost-greeting"></p>
            <p class="history-prompt" id="history-prompt"></p>
            <div class="history-buttons" id="history-buttons">
                <button class="history-button" id="reveal-history-btn">Yes, tell me</button>
                <button class="history-button decline" id="decline-history-btn">No, leave me alone</button>
            </div>
        </div>
        
        <button id="close-encounter-btn" class="close-button" style="position: absolute; top: 2rem; right: 2rem; z-index: 20;" aria-label="Close encounter">√ó</button>
    </div>

    <!-- Screen Effects -->
    <div id="vignette-effect" class="vignette-effect"></div>
    <div id="red-vignette-effect" class="red-vignette-effect"></div>
    <div id="transition-overlay" class="transition-overlay">
        <div class="transition-content">
            <p class="transition-text">The veil is lifting...</p>
        </div>
    </div>
    
    <!-- Distorted Text Overlay (for s√©ance room timeout) -->
    <div id="distorted-text-overlay" class="distorted-text-overlay">
        <div class="distorted-text-content" id="distorted-text-content"></div>
    </div>
    
    <!-- Static Overlay (for decline ghost effect) -->
    <div id="static-overlay" class="static-overlay">
        <div class="static-content" id="static-content"></div>
    </div>

    <!-- Error/Message Overlay -->
    <div id="message-overlay" class="message-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="message-text">
        <div class="message-content scary-message">
            <p id="message-text" role="alert"></p>
            <button id="message-close-btn" class="message-button" aria-label="Close message">OK</button>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/utils.js"></script>
    <script src="js/storage-service.js"></script>
    <script src="js/media-manager.js"></script>
    <script src="js/recording-service.js"></script>
    <script src="js/transcription-service.js"></script>
    <script src="js/song-service.js"></script>
    <script src="js/story-service.js"></script>
    <script src="js/seance-service.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
